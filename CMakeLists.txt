cmake_policy(SET CMP0091 NEW)
cmake_minimum_required(VERSION 3.21)

project(infernal-synth)
SET(INFERNAL_VERSION "1.1")

set(CMAKE_CXX_STANDARD 20)
set(CMAKE_CXX_EXTENSIONS OFF)
set(CMAKE_CXX_STANDARD_REQUIRED ON)
set(CMAKE_CONFIGURATION_TYPES "Debug;Release")
set(CMAKE_CXX_FLAGS_RELEASE "${CMAKE_CXX_FLAGS_RELEASE} -DRELEASE=1")
set(CMAKE_CXX_FLAGS_DEBUG "${CMAKE_CXX_FLAGS_DEBUG} -DDEVELOPMENT=1")

if (MSVC)
add_compile_options(/W4)
add_compile_options(/WX)
add_compile_options(/wd4100)
add_compile_options(/wd4388)
add_compile_options(/wd26451)
add_compile_options(/wd26498)
add_compile_options(/wd26812)
add_compile_options(/external:W0)
add_compile_options(/fp:fast)
add_compile_options(/arch:AVX2)
#add_compile_options(/Qvec-report:2)
add_definitions(-D_CRT_SECURE_NO_WARNINGS)
string(REPLACE "/" "\\" VST_SDK_377_SRC_DIR_WIN32 ${VST_SDK_377_SRC_DIR})
else ()
add_compile_options(-std=c++2a)
add_compile_options(-Wall)
add_compile_options(-Wextra)
add_compile_options(-Werror)
add_compile_options(-Wno-sign-compare)
add_compile_options(-Wno-unused-parameter)
add_compile_options(-mavx2)
add_compile_options(-ffast-math)
set(CMAKE_CXX_FLAGS "${CMAKE_CXX_FLAGS} -fPIC")
endif()

# VST SDK debug binaries.
find_library(VST3_BASE_LIB_Debug base PATHS "${VST_SDK_377_BUILD_DEBUG_DIR}")
find_library(VST3_SDK_LIB_Debug sdk PATHS "${VST_SDK_377_BUILD_DEBUG_DIR}")
find_library(VST3_SDK_COMMON_LIB_Debug sdk_common PATHS "${VST_SDK_377_BUILD_DEBUG_DIR}")
find_library(VST3_PLUGINTERFACES_LIB_Debug pluginterfaces PATHS "${VST_SDK_377_BUILD_DEBUG_DIR}")
find_library(VST3_VSTGUI_LIB_Debug vstgui PATHS "${VST_SDK_377_BUILD_DEBUG_DIR}")
find_library(VST3_VSTGUI_SUPPORT_LIB_Debug vstgui_support PATHS "${VST_SDK_377_BUILD_DEBUG_DIR}")
find_library(VST3_VSTGUI_UIDESCRIPTION_LIB_Debug vstgui_uidescription PATHS "${VST_SDK_377_BUILD_DEBUG_DIR}")

# VST SDK release binaries.
find_library(VST3_BASE_LIB_Release base PATHS "${VST_SDK_377_BUILD_RELEASE_DIR}")
find_library(VST3_SDK_LIB_Release sdk PATHS "${VST_SDK_377_BUILD_RELEASE_DIR}")
find_library(VST3_SDK_COMMON_LIB_Release sdk_common PATHS "${VST_SDK_377_BUILD_RELEASE_DIR}")
find_library(VST3_PLUGINTERFACES_LIB_Release pluginterfaces PATHS "${VST_SDK_377_BUILD_RELEASE_DIR}")
find_library(VST3_VSTGUI_LIB_Release vstgui PATHS "${VST_SDK_377_BUILD_RELEASE_DIR}")
find_library(VST3_VSTGUI_SUPPORT_LIB_Release vstgui_support PATHS "${VST_SDK_377_BUILD_RELEASE_DIR}")
find_library(VST3_VSTGUI_UIDESCRIPTION_LIB_Release vstgui_uidescription PATHS "${VST_SDK_377_BUILD_RELEASE_DIR}")

# Inf base library.
set(INF_BASE_SRC_DIR "src/inf.base")
file(GLOB_RECURSE INF_BASE_SRC "${INF_BASE_SRC_DIR}/*.*")
add_library(infernal.base STATIC ${INF_BASE_SRC})
target_include_directories(infernal.base PRIVATE ${INF_BASE_SRC_DIR})
target_include_directories(infernal.base SYSTEM PRIVATE ${HIIR_140_SRC_DIR})
if (MSVC)
source_group(TREE "../../${INF_BASE_SRC_DIR}" FILES ${INF_BASE_SRC})
endif()

# Inf synth library.
set(INF_SYNTH_SRC_DIR "src/inf.synth")
file(GLOB_RECURSE INF_SYNTH_SRC "${INF_SYNTH_SRC_DIR}/*.*")
add_library(infernal.synth STATIC ${INF_SYNTH_SRC})
target_include_directories(infernal.synth PRIVATE ${INF_BASE_SRC_DIR})
target_include_directories(infernal.synth PRIVATE ${INF_SYNTH_SRC_DIR})
target_include_directories(infernal.synth SYSTEM PRIVATE ${HIIR_140_SRC_DIR})
target_link_libraries(infernal.synth infernal.base)
if (MSVC)
source_group(TREE "../../${INF_SYNTH_SRC_DIR}" FILES ${INF_SYNTH_SRC})
endif()

# Inf vst base library.
set(INF_VST_BASE_SRC_DIR "src/inf.vst.base")
file(GLOB_RECURSE INF_VST_BASE_SRC "${INF_VST_BASE_SRC_DIR}/*.*")
add_library(infernal.vst.base STATIC ${INF_VST_BASE_SRC})
target_compile_definitions(infernal.vst.base PRIVATE $<$<CONFIG:Debug>:DEVELOPMENT=1>)
target_include_directories(infernal.vst.base PRIVATE ${INF_BASE_SRC_DIR})
target_include_directories(infernal.vst.base PRIVATE ${INF_VST_BASE_SRC_DIR})
target_include_directories(infernal.vst.base SYSTEM PRIVATE ${VST_SDK_377_SRC_DIR})
target_include_directories(infernal.vst.base SYSTEM PRIVATE ${VST_SDK_377_SRC_DIR}/vstgui4)
target_link_libraries(infernal.vst.base infernal.base)
target_link_libraries(infernal.vst.base debug "${VST3_BASE_LIB_Debug}" optimized "${VST3_BASE_LIB_Release}")
target_link_libraries(infernal.vst.base debug "${VST3_SDK_LIB_Debug}" optimized "${VST3_SDK_LIB_Release}")
target_link_libraries(infernal.vst.base debug "${VST3_SDK_COMMON_LIB_Debug}" optimized "${VST3_SDK_COMMON_LIB_Release}")
target_link_libraries(infernal.vst.base debug "${VST3_PLUGINTERFACES_LIB_Debug}" optimized "${VST3_PLUGINTERFACES_LIB_Release}")
target_link_libraries(infernal.vst.base debug "${VST3_VSTGUI_LIB_Debug}" optimized "${VST3_VSTGUI_LIB_Release}")
target_link_libraries(infernal.vst.base debug "${VST3_VSTGUI_SUPPORT_LIB_Debug}" optimized "${VST3_VSTGUI_SUPPORT_LIB_Release}")
target_link_libraries(infernal.vst.base debug "${VST3_VSTGUI_UIDESCRIPTION_LIB_Debug}" optimized "${VST3_VSTGUI_UIDESCRIPTION_LIB_Release}")
if (MSVC)
source_group(TREE "../../${INF_VST_BASE_SRC_DIR}" FILES ${INF_VST_BASE_SRC})
target_compile_options(infernal.vst.base PRIVATE /external:I ${VST_SDK_377_SRC_DIR_WIN32})
endif()

# Inf vst synth fx generic.
set(INF_VST_SYNTH_FX_GENERIC_SRC_DIR "src/inf.vst.synth.fx")
file(GLOB_RECURSE INF_VST_SYNTH_FX_GENERIC_SRC "${INF_VST_SYNTH_FX_GENERIC_SRC_DIR}/*.*")
add_library(infernal.vst.synth.fx.generic SHARED ${INF_VST_SYNTH_FX_GENERIC_SRC})
target_compile_definitions(infernal.vst.synth.fx.generic PRIVATE -DINF_VERSIONED=0)
target_include_directories(infernal.vst.synth.fx.generic PRIVATE ${INF_BASE_SRC_DIR})
target_include_directories(infernal.vst.synth.fx.generic PRIVATE ${INF_SYNTH_SRC_DIR})
target_include_directories(infernal.vst.synth.fx.generic PRIVATE ${INF_VST_BASE_SRC_DIR})
target_include_directories(infernal.vst.synth.fx.generic PRIVATE ${INF_VST_SYNTH_FX_GENERIC_SRC_DIR})
target_include_directories(infernal.vst.synth.fx.generic SYSTEM PRIVATE ${VST_SDK_377_SRC_DIR})
target_include_directories(infernal.vst.synth.fx.generic SYSTEM PRIVATE ${VST_SDK_377_SRC_DIR}/vstgui4)
target_link_libraries(infernal.vst.synth.fx.generic infernal.base)
target_link_libraries(infernal.vst.synth.fx.generic infernal.synth)
target_link_libraries(infernal.vst.synth.fx.generic infernal.vst.base)
set_target_properties(infernal.vst.synth.fx.generic PROPERTIES SUFFIX ".vst3")
set_target_properties(infernal.vst.synth.fx.generic PROPERTIES OUTPUT_NAME "InfernalSynthFX")
set_target_properties(infernal.vst.synth.fx.generic PROPERTIES RUNTIME_OUTPUT_DIRECTORY_DEBUG "${CMAKE_BINARY_DIR}/Debug/InfernalSynth/Generic/InfernalSynthFX.vst3/Contents/x86_64-win")
set_target_properties(infernal.vst.synth.fx.generic PROPERTIES RUNTIME_OUTPUT_DIRECTORY_RELEASE "${CMAKE_BINARY_DIR}/Release/InfernalSynth/Generic/InfernalSynthFX.vst3/Contents/x86_64-win")
add_custom_target(copy-resources-synth-fx-generic-debug ALL DEPENDS infernal.vst.synth.fx.generic COMMAND ${CMAKE_COMMAND} -E copy_directory ${CMAKE_SOURCE_DIR}/resources ${CMAKE_BINARY_DIR}/Debug/InfernalSynth/Generic/InfernalSynthFX.vst3/Contents/Resources)
add_custom_target(copy-resources-synth-fx-generic-release ALL DEPENDS infernal.vst.synth.fx.generic COMMAND ${CMAKE_COMMAND} -E copy_directory ${CMAKE_SOURCE_DIR}/resources ${CMAKE_BINARY_DIR}/Release/InfernalSynth/Generic/InfernalSynthFX.vst3/Contents/Resources)
add_custom_target(copy-presets-synth-fx-generic-debug ALL DEPENDS infernal.vst.synth.fx.generic COMMAND ${CMAKE_COMMAND} -E copy_directory ${CMAKE_SOURCE_DIR}/presets/fx ${CMAKE_BINARY_DIR}/Debug/InfernalSynth/Generic/InfernalSynthFX.vst3/Contents/Resources)
add_custom_target(copy-presets-synth-fx-generic-release ALL DEPENDS infernal.vst.synth.fx.generic COMMAND ${CMAKE_COMMAND} -E copy_directory ${CMAKE_SOURCE_DIR}/presets/fx ${CMAKE_BINARY_DIR}/Release/InfernalSynth/Generic/InfernalSynthFX.vst3/Contents/Resources)
add_custom_target(copy-uidesc-synth-fx-generic-debug ALL DEPENDS infernal.vst.synth.fx.generic COMMAND ${CMAKE_COMMAND} -E copy ${CMAKE_SOURCE_DIR}/resources/controller.uidesc ${CMAKE_BINARY_DIR}/Debug/InfernalSynth/Generic/InfernalSynthFX.vst3/Contents/Resources/controller.uidesc)
add_custom_target(copy-uidesc-synth-fx-generic-release ALL DEPENDS infernal.vst.synth.fx.generic COMMAND ${CMAKE_COMMAND} -E copy ${CMAKE_SOURCE_DIR}/resources/controller.uidesc ${CMAKE_BINARY_DIR}/Release/InfernalSynth/Generic/InfernalSynthFX.vst3/Contents/Resources/controller.uidesc)

if (MSVC)
source_group(TREE "../../${INF_VST_SYNTH_FX_GENERIC_SRC_DIR}" FILES ${INF_VST_SYNTH_FX_GENERIC_SRC})
target_compile_options(infernal.vst.synth.fx.generic PRIVATE /external:I ${VST_SDK_377_SRC_DIR_WIN32})
endif()

# Inf vst synth fx versioned.
set(INF_VST_SYNTH_FX_VERSIONED_SRC_DIR "src/inf.vst.synth.fx")
file(GLOB_RECURSE INF_VST_SYNTH_FX_VERSIONED_SRC "${INF_VST_SYNTH_FX_VERSIONED_SRC_DIR}/*.*")
add_library(infernal.vst.synth.fx.versioned SHARED ${INF_VST_SYNTH_FX_VERSIONED_SRC})
target_compile_definitions(infernal.vst.synth.fx.versioned PRIVATE -DINF_VERSIONED=1)
target_include_directories(infernal.vst.synth.fx.versioned PRIVATE ${INF_BASE_SRC_DIR})
target_include_directories(infernal.vst.synth.fx.versioned PRIVATE ${INF_SYNTH_SRC_DIR})
target_include_directories(infernal.vst.synth.fx.versioned PRIVATE ${INF_VST_BASE_SRC_DIR})
target_include_directories(infernal.vst.synth.fx.versioned PRIVATE ${INF_VST_SYNTH_FX_VERSIONED_SRC_DIR})
target_include_directories(infernal.vst.synth.fx.versioned SYSTEM PRIVATE ${VST_SDK_377_SRC_DIR})
target_include_directories(infernal.vst.synth.fx.versioned SYSTEM PRIVATE ${VST_SDK_377_SRC_DIR}/vstgui4)
target_link_libraries(infernal.vst.synth.fx.versioned infernal.base)
target_link_libraries(infernal.vst.synth.fx.versioned infernal.synth)
target_link_libraries(infernal.vst.synth.fx.versioned infernal.vst.base)
set_target_properties(infernal.vst.synth.fx.versioned PROPERTIES SUFFIX ".vst3")
set_target_properties(infernal.vst.synth.fx.versioned PROPERTIES OUTPUT_NAME "InfernalSynthFX${INFERNAL_VERSION}")
set_target_properties(infernal.vst.synth.fx.versioned PROPERTIES RUNTIME_OUTPUT_DIRECTORY_DEBUG "${CMAKE_BINARY_DIR}/Debug/InfernalSynth/Versioned/InfernalSynthFX${INFERNAL_VERSION}.vst3/Contents/x86_64-win")
set_target_properties(infernal.vst.synth.fx.versioned PROPERTIES RUNTIME_OUTPUT_DIRECTORY_RELEASE "${CMAKE_BINARY_DIR}/Release/InfernalSynth/Versioned/InfernalSynthFX${INFERNAL_VERSION}.vst3/Contents/x86_64-win")
add_custom_target(copy-resources-synth-fx-versioned-debug ALL DEPENDS infernal.vst.synth.fx.versioned COMMAND ${CMAKE_COMMAND} -E copy_directory ${CMAKE_SOURCE_DIR}/resources ${CMAKE_BINARY_DIR}/Debug/InfernalSynth/Versioned/InfernalSynthFX${INFERNAL_VERSION}.vst3/Contents/Resources)
add_custom_target(copy-resources-synth-fx-versioned-release ALL DEPENDS infernal.vst.synth.fx.versioned COMMAND ${CMAKE_COMMAND} -E copy_directory ${CMAKE_SOURCE_DIR}/resources ${CMAKE_BINARY_DIR}/Release/InfernalSynth/Versioned/InfernalSynthFX${INFERNAL_VERSION}.vst3/Contents/Resources)
add_custom_target(copy-presets-synth-fx-versioned-debug ALL DEPENDS infernal.vst.synth.fx.versioned COMMAND ${CMAKE_COMMAND} -E copy_directory ${CMAKE_SOURCE_DIR}/presets/fx ${CMAKE_BINARY_DIR}/Debug/InfernalSynth/Versioned/InfernalSynthFX${INFERNAL_VERSION}.vst3/Contents/Resources)
add_custom_target(copy-presets-synth-fx-versioned-release ALL DEPENDS infernal.vst.synth.fx.versioned COMMAND ${CMAKE_COMMAND} -E copy_directory ${CMAKE_SOURCE_DIR}/presets/fx ${CMAKE_BINARY_DIR}/Release/InfernalSynth/Versioned/InfernalSynthFX${INFERNAL_VERSION}.vst3/Contents/Resources)
add_custom_target(copy-uidesc-synth-fx-versioned-debug ALL DEPENDS infernal.vst.synth.fx.versioned COMMAND ${CMAKE_COMMAND} -E copy ${CMAKE_SOURCE_DIR}/resources/controller.uidesc ${CMAKE_BINARY_DIR}/Debug/InfernalSynth/Versioned/InfernalSynthFX${INFERNAL_VERSION}.vst3/Contents/Resources/controller.uidesc)
add_custom_target(copy-uidesc-synth-fx-versioned-release ALL DEPENDS infernal.vst.synth.fx.versioned COMMAND ${CMAKE_COMMAND} -E copy ${CMAKE_SOURCE_DIR}/resources/controller.uidesc ${CMAKE_BINARY_DIR}/Release/InfernalSynth/Versioned/InfernalSynthFX${INFERNAL_VERSION}.vst3/Contents/Resources/controller.uidesc)

if (MSVC)
source_group(TREE "../../${INF_VST_SYNTH_FX_VERSIONED_SRC_DIR}" FILES ${INF_VST_SYNTH_FX_VERSIONED_SRC})
target_compile_options(infernal.vst.synth.fx.versioned PRIVATE /external:I ${VST_SDK_377_SRC_DIR_WIN32})
endif()

# Inf vst synth instrument generic.
set(INF_VST_SYNTH_INSTRUMENT_GENERIC_SRC_DIR "src/inf.vst.synth.instrument")
file(GLOB_RECURSE INF_VST_SYNTH_INSTRUMENT_GENERIC_SRC "${INF_VST_SYNTH_INSTRUMENT_GENERIC_SRC_DIR}/*.*")
add_library(infernal.vst.synth.instrument.generic SHARED ${INF_VST_SYNTH_INSTRUMENT_GENERIC_SRC})
target_compile_definitions(infernal.vst.synth.instrument.generic PRIVATE -DINF_VERSIONED=0)
target_include_directories(infernal.vst.synth.instrument.generic PRIVATE ${INF_BASE_SRC_DIR})
target_include_directories(infernal.vst.synth.instrument.generic PRIVATE ${INF_SYNTH_SRC_DIR})
target_include_directories(infernal.vst.synth.instrument.generic PRIVATE ${INF_VST_BASE_SRC_DIR})
target_include_directories(infernal.vst.synth.instrument.generic PRIVATE ${INF_VST_SYNTH_INSTRUMENT_GENERIC_SRC_DIR})
target_include_directories(infernal.vst.synth.instrument.generic SYSTEM PRIVATE ${VST_SDK_377_SRC_DIR})
target_include_directories(infernal.vst.synth.instrument.generic SYSTEM PRIVATE ${VST_SDK_377_SRC_DIR}/vstgui4)
target_link_libraries(infernal.vst.synth.instrument.generic infernal.base)
target_link_libraries(infernal.vst.synth.instrument.generic infernal.synth)
target_link_libraries(infernal.vst.synth.instrument.generic infernal.vst.base)
set_target_properties(infernal.vst.synth.instrument.generic PROPERTIES SUFFIX ".vst3")
set_target_properties(infernal.vst.synth.instrument.generic PROPERTIES OUTPUT_NAME "InfernalSynth")
set_target_properties(infernal.vst.synth.instrument.generic PROPERTIES RUNTIME_OUTPUT_DIRECTORY_DEBUG "${CMAKE_BINARY_DIR}/Debug/InfernalSynth/Generic/InfernalSynth.vst3/Contents/x86_64-win")
set_target_properties(infernal.vst.synth.instrument.generic PROPERTIES RUNTIME_OUTPUT_DIRECTORY_RELEASE "${CMAKE_BINARY_DIR}/Release/InfernalSynth/Generic/InfernalSynth.vst3/Contents/x86_64-win")
add_custom_target(copy-resources-synth-instrument-generic-debug ALL DEPENDS infernal.vst.synth.instrument.generic COMMAND ${CMAKE_COMMAND} -E copy_directory ${CMAKE_SOURCE_DIR}/resources ${CMAKE_BINARY_DIR}/Debug/InfernalSynth/Generic/InfernalSynth.vst3/Contents/Resources)
add_custom_target(copy-resources-synth-instrument-generic-release ALL DEPENDS infernal.vst.synth.instrument.generic COMMAND ${CMAKE_COMMAND} -E copy_directory ${CMAKE_SOURCE_DIR}/resources ${CMAKE_BINARY_DIR}/Release/InfernalSynth/Generic/InfernalSynth.vst3/Contents/Resources)
add_custom_target(copy-presets-synth-instrument-generic-debug ALL DEPENDS infernal.vst.synth.instrument.generic COMMAND ${CMAKE_COMMAND} -E copy_directory ${CMAKE_SOURCE_DIR}/presets/instrument ${CMAKE_BINARY_DIR}/Debug/InfernalSynth/Generic/InfernalSynth.vst3/Contents/Resources)
add_custom_target(copy-presets-synth-instrument-generic-release ALL DEPENDS infernal.vst.synth.instrument.generic COMMAND ${CMAKE_COMMAND} -E copy_directory ${CMAKE_SOURCE_DIR}/presets/instrument ${CMAKE_BINARY_DIR}/Release/InfernalSynth/Generic/InfernalSynth.vst3/Contents/Resources)
add_custom_target(copy-uidesc-synth-instrument-generic-debug ALL DEPENDS infernal.vst.synth.instrument.generic COMMAND ${CMAKE_COMMAND} -E copy ${CMAKE_SOURCE_DIR}/resources/controller.uidesc ${CMAKE_BINARY_DIR}/Debug/InfernalSynth/Generic/InfernalSynth.vst3/Contents/Resources/controller.uidesc)
add_custom_target(copy-uidesc-synth-instrument-generic-release ALL DEPENDS infernal.vst.synth.instrument.generic COMMAND ${CMAKE_COMMAND} -E copy ${CMAKE_SOURCE_DIR}/resources/controller.uidesc ${CMAKE_BINARY_DIR}/Release/InfernalSynth/Generic/InfernalSynth.vst3/Contents/Resources/controller.uidesc)

if (MSVC)
source_group(TREE "../../${INF_VST_SYNTH_INSTRUMENT_GENERIC_SRC_DIR}" FILES ${INF_VST_SYNTH_INSTRUMENT_GENERIC_SRC})
target_compile_options(infernal.vst.synth.instrument.generic PRIVATE /external:I ${VST_SDK_377_SRC_DIR_WIN32})
endif()

# Inf vst synth instrument versioned.
set(INF_VST_SYNTH_INSTRUMENT_VERSIONED_SRC_DIR "src/inf.vst.synth.instrument")
file(GLOB_RECURSE INF_VST_SYNTH_INSTRUMENT_VERSIONED_SRC "${INF_VST_SYNTH_INSTRUMENT_VERSIONED_SRC_DIR}/*.*")
add_library(infernal.vst.synth.instrument.versioned SHARED ${INF_VST_SYNTH_INSTRUMENT_VERSIONED_SRC})
target_compile_definitions(infernal.vst.synth.instrument.versioned PRIVATE -DINF_VERSIONED=1)
target_include_directories(infernal.vst.synth.instrument.versioned PRIVATE ${INF_BASE_SRC_DIR})
target_include_directories(infernal.vst.synth.instrument.versioned PRIVATE ${INF_SYNTH_SRC_DIR})
target_include_directories(infernal.vst.synth.instrument.versioned PRIVATE ${INF_VST_BASE_SRC_DIR})
target_include_directories(infernal.vst.synth.instrument.versioned PRIVATE ${INF_VST_SYNTH_INSTRUMENT_VERSIONED_SRC_DIR})
target_include_directories(infernal.vst.synth.instrument.versioned SYSTEM PRIVATE ${VST_SDK_377_SRC_DIR})
target_include_directories(infernal.vst.synth.instrument.versioned SYSTEM PRIVATE ${VST_SDK_377_SRC_DIR}/vstgui4)
target_link_libraries(infernal.vst.synth.instrument.versioned infernal.base)
target_link_libraries(infernal.vst.synth.instrument.versioned infernal.synth)
target_link_libraries(infernal.vst.synth.instrument.versioned infernal.vst.base)
set_target_properties(infernal.vst.synth.instrument.versioned PROPERTIES SUFFIX ".vst3")
set_target_properties(infernal.vst.synth.instrument.versioned PROPERTIES OUTPUT_NAME "InfernalSynth${INFERNAL_VERSION}")
set_target_properties(infernal.vst.synth.instrument.versioned PROPERTIES RUNTIME_OUTPUT_DIRECTORY_DEBUG "${CMAKE_BINARY_DIR}/Debug/InfernalSynth/Versioned/InfernalSynth${INFERNAL_VERSION}.vst3/Contents/x86_64-win")
set_target_properties(infernal.vst.synth.instrument.versioned PROPERTIES RUNTIME_OUTPUT_DIRECTORY_RELEASE "${CMAKE_BINARY_DIR}/Release/InfernalSynth/Versioned/InfernalSynth${INFERNAL_VERSION}.vst3/Contents/x86_64-win")
add_custom_target(copy-resources-synth-instrument-versioned-debug ALL DEPENDS infernal.vst.synth.instrument.versioned COMMAND ${CMAKE_COMMAND} -E copy_directory ${CMAKE_SOURCE_DIR}/resources ${CMAKE_BINARY_DIR}/Debug/InfernalSynth/Versioned/InfernalSynth${INFERNAL_VERSION}.vst3/Contents/Resources)
add_custom_target(copy-resources-synth-instrument-versioned-release ALL DEPENDS infernal.vst.synth.instrument.versioned COMMAND ${CMAKE_COMMAND} -E copy_directory ${CMAKE_SOURCE_DIR}/resources ${CMAKE_BINARY_DIR}/Release/InfernalSynth/Versioned/InfernalSynth${INFERNAL_VERSION}.vst3/Contents/Resources)
add_custom_target(copy-presets-synth-instrument-versioned-debug ALL DEPENDS infernal.vst.synth.instrument.versioned COMMAND ${CMAKE_COMMAND} -E copy_directory ${CMAKE_SOURCE_DIR}/presets/instrument ${CMAKE_BINARY_DIR}/Debug/InfernalSynth/Versioned/InfernalSynth${INFERNAL_VERSION}.vst3/Contents/Resources)
add_custom_target(copy-presets-synth-instrument-versioned-release ALL DEPENDS infernal.vst.synth.instrument.versioned COMMAND ${CMAKE_COMMAND} -E copy_directory ${CMAKE_SOURCE_DIR}/presets/instrument ${CMAKE_BINARY_DIR}/Release/InfernalSynth/Versioned/InfernalSynth${INFERNAL_VERSION}.vst3/Contents/Resources)
add_custom_target(copy-uidesc-synth-instrument-versioned-debug ALL DEPENDS infernal.vst.synth.instrument.versioned COMMAND ${CMAKE_COMMAND} -E copy ${CMAKE_SOURCE_DIR}/resources/controller.uidesc ${CMAKE_BINARY_DIR}/Debug/InfernalSynth/Versioned/InfernalSynth${INFERNAL_VERSION}.vst3/Contents/Resources/controller.uidesc)
add_custom_target(copy-uidesc-synth-instrument-versioned-release ALL DEPENDS infernal.vst.synth.instrument.versioned COMMAND ${CMAKE_COMMAND} -E copy ${CMAKE_SOURCE_DIR}/resources/controller.uidesc ${CMAKE_BINARY_DIR}/Release/InfernalSynth/Versioned/InfernalSynth${INFERNAL_VERSION}.vst3/Contents/Resources/controller.uidesc)

if (MSVC)
source_group(TREE "../../${INF_VST_SYNTH_INSTRUMENT_VERSIONED_SRC_DIR}" FILES ${INF_VST_SYNTH_INSTRUMENT_VERSIONED_SRC})
target_compile_options(infernal.vst.synth.instrument.versioned PRIVATE /external:I ${VST_SDK_377_SRC_DIR_WIN32})
endif()

# Inf vst ui generator and preset diff tool.
set(INF_VST_TOOL_SRC_DIR "src/inf.vst.tool")
file(GLOB_RECURSE INF_VST_TOOL_SRC "${INF_VST_TOOL_SRC_DIR}/*.*")
add_executable(infernal.vst.tool ${INF_VST_TOOL_SRC})
target_include_directories(infernal.vst.tool PRIVATE ${INF_BASE_SRC_DIR})
target_include_directories(infernal.vst.tool PRIVATE ${INF_VST_BASE_SRC_DIR})
target_include_directories(infernal.vst.tool PRIVATE ${INF_VST_TOOL_SRC_DIR})
target_include_directories(infernal.vst.tool SYSTEM PRIVATE ${VST_SDK_377_SRC_DIR})
target_include_directories(infernal.vst.tool SYSTEM PRIVATE ${VST_SDK_377_SRC_DIR}/vstgui4)
target_link_libraries(infernal.vst.tool infernal.base)
target_link_libraries(infernal.vst.tool infernal.vst.base)
if (MSVC)
source_group(TREE "../../${INF_VST_TOOL_SRC_DIR}" FILES ${INF_VST_TOOL_SRC})
target_compile_options(infernal.vst.tool PRIVATE /external:I ${VST_SDK_377_SRC_DIR_WIN32})
else ()
target_link_libraries(infernal.vst.tool dl)
endif()
